<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-queue/architecture">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">Architecture | Switchboard</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.switchboard.xyz/queue"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Architecture | Switchboard"><meta data-rh="true" name="description" content="An oracle queue is an independent realm of oracles, responsible for allocating oracle resources for update requests from data feeds, randomness, or buffer relayers. Oracle queue&#x27;s act as an aggregator for on-chain consumers looking to publish data on-chain by specifying an upfront reward a requester is required to pay when a new update is requested by an oracle. Oracles act as an off-chain compute resource that can be utilized by on-chain programs needing a decentralized way to source data."><meta data-rh="true" property="og:description" content="An oracle queue is an independent realm of oracles, responsible for allocating oracle resources for update requests from data feeds, randomness, or buffer relayers. Oracle queue&#x27;s act as an aggregator for on-chain consumers looking to publish data on-chain by specifying an upfront reward a requester is required to pay when a new update is requested by an oracle. Oracles act as an off-chain compute resource that can be utilized by on-chain programs needing a decentralized way to source data."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.switchboard.xyz/queue"><link data-rh="true" rel="alternate" href="https://docs.switchboard.xyz/queue" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.switchboard.xyz/queue" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.756b9556.css">
<link rel="preload" href="/assets/js/runtime~main.167300c3.js" as="script">
<link rel="preload" href="/assets/js/main.006ccf51.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_BxGa">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Switchboard Logo" class="themedImage_aIr_ themedImage--light_DGIu"><img src="/img/logo_white.svg" alt="Switchboard Logo" class="themedImage_aIr_ themedImage--dark_RoHN"></div><b class="navbar__title">Switchboard Documentation</b></a><a class="navbar__item navbar__link navbar__link--active" href="/introduction">Docs</a><a class="navbar__item navbar__link" href="/idl">IDL</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/api">APIs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/api/tasks">Task Protobufs</a></li><li><a href="https://docs.switchboard.xyz/api/ts" target="_blank" rel="noopener noreferrer" class="dropdown__link">Typescript</a></li><li><a href="https://docs.switchboard.xyz/api/ts-lite" target="_blank" rel="noopener noreferrer" class="dropdown__link">Typescript Lite</a></li><li><a href="https://docs.switchboard.xyz/api/py" target="_blank" rel="noopener noreferrer" class="dropdown__link">Python</a></li><li><a href="https://docs.rs/switchboard-v2/latest/switchboard_v2/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Rust</a></li><li><a class="dropdown__link" href="/api/cli">CLI</a></li></ul></div><a href="https://publish.switchboard.xyz/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Publish</a><a href="https://switchboardxyz.medium.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_NpMu"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/queue" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li></ul></div><a href="https://github.com/switchboard-xyz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_IT2h colorModeToggle_o_qc"><button class="clean-btn toggleButton_pGki toggleButtonDisabled_vZLo" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_dYsV"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_WRF1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_zNSk"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_ecpa" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_NEdF"><div class="sidebar_Uz2u"><nav class="menu thin-scrollbar menu_XU2j"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/program">Program</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/queue">Oracle Queue</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/queue">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/queue/private-queues">Private Queues</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/oracle">Oracles</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/feed">Data Feeds</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/randomness">Randomness</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/buffer-relayer">Buffer Relayers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/developers">Developers</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dao">Switchboard DAO</a></li></ul></nav></div></aside><main class="docMainContainer_vJqy"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_ygLL"><div class="docItemContainer_yJzi"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_nmcO" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">üè†</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">Oracle Queue</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">Architecture</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_aX8Q theme-doc-toc-mobile tocMobile_By44"><button type="button" class="clean-btn tocCollapsibleButton_Va7b">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Oracle Queue Architecture</h1><p>An oracle queue is an independent realm of oracles, responsible for allocating oracle resources for update requests from data feeds, randomness, or buffer relayers. Oracle queue&#x27;s act as an aggregator for on-chain consumers looking to publish data on-chain by specifying an upfront reward a requester is required to pay when a new update is requested by an oracle. Oracles act as an off-chain compute resource that can be utilized by on-chain programs needing a decentralized way to source data.</p><p>Each oracle queue is independent and maintain their own configurations, which dictates its degree of security. Queue&#x27;s can require update requesters to be pre-approved to use a queues resources or allow any requester access to a queue. Queue&#x27;s also specify a minimum stake oracles must maintain in their escrow wallet before joining a queue, which acts as a deposit to incentivize honest oracle behavior.</p><p>Oracle queue&#x27;s currently support update requests from the following resource types:</p><table><thead><tr><th>Resource Type</th><th>Description</th></tr></thead><tbody><tr><td><strong>Data Feeds</strong></td><td>Utilize a batch of oracles to resolve a data point from a variety of source and determine the final result as the median of oracle responses <br><em>Can be a price feed, sport result, or any data point found on the internet</em></td></tr><tr><td><strong>Randomness</strong></td><td>Utilize an oracle to publish and verify a Verifiable Randomness Function on-chain.<br><em>Can be used for fair NFT launches, decentralized lottery, or any random assignment</em></td></tr><tr><td><strong>Buffer Relayer</strong></td><td>Utilize an oracle to relay and publish a buffer on-chain<br><em>Can be used by programs needing a way to quickly source data on-chain that may not need as many security guarantees as a price feed </em></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_YDjN" id="configuration">Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">‚Äã</a></h2><style data-emotion="css isbt42">.css-isbt42{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin-top:-16px;width:calc(100% + 16px);margin-left:-16px;}.css-isbt42>.MuiGrid-item{padding-top:16px;}.css-isbt42>.MuiGrid-item{padding-left:16px;}</style><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-2 css-isbt42"><style data-emotion="css fq28xq">.css-fq28xq{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}@media (min-width:600px){.css-fq28xq{-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}}@media (min-width:900px){.css-fq28xq{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:33.333333%;}}@media (min-width:1200px){.css-fq28xq{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:33.333333%;}}@media (min-width:1536px){.css-fq28xq{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:33.333333%;}}</style><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-sm-12 MuiGrid-grid-md-4 css-fq28xq"><ul><li><b>Oracle Queue: </b>Contains the Oracle Queue&#x27;s configuration parameters that influence its security model.</li><br><li><b>Oracle Queue Buffer: </b>Stores the current list of oracles actively heartbeating on-chain.</li><br><li><b>Oracle: </b>Off-chain resource used by a queue to fulfill update request.</li><br><li><b>Crank: </b>Optional, Crank Account that permits data feeds to join and request periodic updates.</li><br><li><b>Crank Buffer: </b>Stores the list of data feeds on a crank along with their next allowed update time.</li></ul></div><style data-emotion="css hcgus0">.css-hcgus0{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}@media (min-width:600px){.css-hcgus0{-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}}@media (min-width:900px){.css-hcgus0{-webkit-flex-basis:66.666667%;-ms-flex-preferred-size:66.666667%;flex-basis:66.666667%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:66.666667%;}}@media (min-width:1200px){.css-hcgus0{-webkit-flex-basis:66.666667%;-ms-flex-preferred-size:66.666667%;flex-basis:66.666667%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:66.666667%;}}@media (min-width:1536px){.css-hcgus0{-webkit-flex-basis:66.666667%;-ms-flex-preferred-size:66.666667%;flex-basis:66.666667%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:66.666667%;}}</style><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-sm-12 MuiGrid-grid-md-8 css-hcgus0"><style data-emotion="css km0j29">.css-km0j29{background-color:inherit;margin:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><img class="MuiBox-root css-km0j29" src="/img/queue/Oracle_Queue_Accounts.jpg"></div></div><hr><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>See <a href="/idl/accounts/OracleQueueAccountData">/idl/accounts/OracleQueueAccountData</a> for the full list of an OracleQueueAccount&#x27;s configuration parameters.</p></div></div><h2 class="anchor anchorWithStickyNavbar_YDjN" id="oracle-queue">Oracle Queue<a class="hash-link" href="#oracle-queue" title="Direct link to heading">‚Äã</a></h2><p>When creating a queue, an OracleQueueBuffer account must also be initialized with a size of 8 Bytes + (32 Bytes √ó <code>queue.maxSize</code>), where <code>queue.maxSize</code> is the maximum number of oracles the queue can support. The OracleQueueBuffer account <code>queue.dataBuffer</code> stores a list of oracle public keys in a round robin fashion, using <code>queue.currIdx</code> to track its position on the queue for allocating resource update request. Once a buffer is full, oracles must be removed before new oracles can join the network. An oracle can be assigned to many update request simultaneously but must continuously heartbeat on-chain to signal readiness.</p><p>An oracle with <strong>PermitOracleHeartbeat</strong> permissions <em>MUST</em> periodically heartbeat on the queue to signal readiness, which adds the oracle to the queue and allows it to be assigned resource update requests. Oracle positions are periodically swapped in the OracleQueueBuffer account to mitigate oracles being assigned the same update requests on each iteration of the queue.</p><p>The queue uses <code>queue.gcIdx</code> to track its garbage collection index. When an oracle heartbeats on-chain, it passes the oracle account at index <code>queue.gcIdx</code>. If the oracle account has failed to heartbeat before <code>queue.oracleTimeout</code>, it is removed from the queue until its next successful heartbeat and will no longer be assigned resource update requests.</p><h2 class="anchor anchorWithStickyNavbar_YDjN" id="access-control">Access Control<a class="hash-link" href="#access-control" title="Direct link to heading">‚Äã</a></h2><p>Oracle queue resources, such as oracles, aggregators, VRF accounts, or buffer relayer accounts, <em>MUST</em> have an associated <a href="/idl/accounts/PermissionAccountData">PermissionAccount</a> initialized before interacting with a queue. Permissions are granted by <code>queue.authority</code>, which could be a DAO controlled account to allow network participants to vote on new entrants.</p><p>Oracles <em>MUST</em> have <strong>PermitOracleHeartbeat</strong> permissions before heartbeating on a queue. This is to prevent a malicious actor from spinning up a plethora of oracles until it obtains the super majority, at which point it could misreport data feed results and cause honest oracles to be slashed.</p><p>See the table below for the minimum required permissions for a resource based on the queues settings:</p><table><thead><tr><th>Queue Setting</th><th>False</th><th>True</th></tr></thead><tbody><tr><td><code>unpermissionedFeedsEnabled</code></td><td>Aggregators &amp; Buffer Relayers <em>MUST</em> have <strong>PermitOracleQueueUsage</strong> permissions before requesting an update</td><td>Aggregators &amp; Buffer Relayers require no explicit permissions before requesting an update</td></tr><tr><td><code>unpermissionedVrfEnabled</code></td><td>VRF Accounts <em>MUST</em> have <strong>PermitVrfRequests</strong> permissions before requesting an update</td><td>VRF Accounts require no explicit permissions before requesting an update</td></tr><tr><td><code>enableBufferRelayers</code></td><td>Buffer Relayers are <em>NOT</em> permitted to request updates</td><td>Buffer Relayers are permitted to request updates</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_YDjN" id="crank">Crank<a class="hash-link" href="#crank" title="Direct link to heading">‚Äã</a></h2><p>A queue can choose to create one or many cranks. A crank is a scheduling mechanism that allows data feeds to request periodic updates. A crank can be turned by anyone, and if successful, the crank turner will be rewarded for jump starting the system.</p><p>A data feed is only permitted to join a crank if it has sufficient permissions (as detailed above) and the crank has available capacity. Data feeds on a crank are ordered by their next available update time with some level of jitter to mitigate oracles being assigned to the same update request upon each iteration of the queue, which makes them susceptible to a malicous oracle. The maximum update interval for a feed on a crank is based on its <code>aggregator.minUpdateDelaySeconds</code> and can be calculated by:</p><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>M</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>d</mi><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>I</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>U</mi><mi>p</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>D</mi><mi>e</mi><mi>l</mi><mi>a</mi><mi>y</mi><mi>S</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>d</mi><mi>s</mi></mrow></msub><mo>+</mo><mo stretchy="false">[</mo><mn>15</mn><mspace width="1em"></mspace><mi mathvariant="normal">%</mi><mspace width="1em"></mspace><msub><mi>I</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>U</mi><mi>p</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>D</mi><mi>e</mi><mi>l</mi><mi>a</mi><mi>y</mi><mi>S</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>d</mi><mi>s</mi></mrow></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">I_{Max} (seconds) = I_{minUpdateDelaySeconds} + [15\quad\% \quad I_{minUpdateDelaySeconds}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">M</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">seco</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">eDe</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span><span class="mord mathnormal mtight">eco</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mopen">[</span><span class="mord">15</span><span class="mspace" style="margin-right:1em"></span><span class="mord">%</span><span class="mspace" style="margin-right:1em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">eDe</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span><span class="mord mathnormal mtight">eco</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></p><h2 class="anchor anchorWithStickyNavbar_YDjN" id="economic-security">Economic Security<a class="hash-link" href="#economic-security" title="Direct link to heading">‚Äã</a></h2><p>An oracle queue uses economic incentives to entice oracles to act honestly, which dictate a queue&#x27;s security model.</p><h3 class="anchor anchorWithStickyNavbar_YDjN" id="stake">Stake<a class="hash-link" href="#stake" title="Direct link to heading">‚Äã</a></h3><p>The queue&#x27;s <code>queue.minStake</code> is the raw token amount in the token mints base unit (<em>Ex: lamports or satoshis</em>) required by an oracle to heartbeat on a queue. If an oracle&#x27;s staking wallet falls below the minStake requirement, it is removed from the queue.</p><p>DeFi protocols with a significant Total Value Locked (TVL) should require oracles with a higher minimum stake to fulfill their update request. Oracles with a higher degree of <em>skin-in-the-game</em> have a greater incentive to respond honestly.</p><h3 class="anchor anchorWithStickyNavbar_YDjN" id="reward">Reward<a class="hash-link" href="#reward" title="Direct link to heading">‚Äã</a></h3><p>The queue&#x27;s specified <code>queue.reward</code> is the number of tokens an oracle or crank turner receives for successfully completing an on-chain action. For a crank turner this is turning the crank and invoking a data feed update. For an oracle this is responding to an update request within the reliable margin from the accepted result.</p><p>Queues should reward oracles enough such that the economic incentive over the lifecycle of the feed exceeds the opportunity cost to attack a protocol consuming the feed.</p><h3 class="anchor anchorWithStickyNavbar_YDjN" id="slashing">Slashing<a class="hash-link" href="#slashing" title="Direct link to heading">‚Äã</a></h3><p>A queue may set <code>queue.slashingEnabled</code> to true in order to dissuade oracles from responding to update request outside a set margin of error.</p><p>A queue&#x27;s <code>queue.varianceToleranceMultiplier</code> determines how many standard deviations an oracle must respond within before being slashed and forfeiting a portion of their stake. <!-- -->[Defaults to 2 std deviations]</p><p>DeFi protocols with a significant TVL should require their feeds to be on a queue with slashing enabled.</p><h2 class="anchor anchorWithStickyNavbar_YDjN" id="governance">Governance<a class="hash-link" href="#governance" title="Direct link to heading">‚Äã</a></h2><p>An oracle queue can be governed by its network participants to control the various queue configuration parameters, such as:</p><ul><li><code>queue.minStake</code> - require a higher up-front cost for oracles to entice honest behavior</li><li><code>queue.reward</code> - control the oracle reward payout for successfully fulfilling update request</li><li><code>queue.slashingEnabled</code> - to disincentivize malicious oracle behavior</li><li>Permit new oracles to join the network</li></ul><h2 class="anchor anchorWithStickyNavbar_YDjN" id="more-information">More Information<a class="hash-link" href="#more-information" title="Direct link to heading">‚Äã</a></h2><ul><li><a href="/idl/accounts/OracleQueueAccountData">/idl/accounts/OracleQueueAccountData</a></li><li><a href="/idl/accounts/OracleQueueBuffer">/idl/accounts/OracleQueueBuffer</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/program"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Program</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/queue/private-queues"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Private Queues</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_jWtb thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li><li><a href="#oracle-queue" class="table-of-contents__link toc-highlight">Oracle Queue</a></li><li><a href="#access-control" class="table-of-contents__link toc-highlight">Access Control</a></li><li><a href="#crank" class="table-of-contents__link toc-highlight">Crank</a></li><li><a href="#economic-security" class="table-of-contents__link toc-highlight">Economic Security</a><ul><li><a href="#stake" class="table-of-contents__link toc-highlight">Stake</a></li><li><a href="#reward" class="table-of-contents__link toc-highlight">Reward</a></li><li><a href="#slashing" class="table-of-contents__link toc-highlight">Slashing</a></li></ul></li><li><a href="#governance" class="table-of-contents__link toc-highlight">Governance</a></li><li><a href="#more-information" class="table-of-contents__link toc-highlight">More Information</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">DOCS</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/developers">Developer Resources</a></li><li class="footer__item"><a href="https://docs.rs/switchboard-v2/latest/switchboard_v2/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Rust API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docs.switchboard.xyz/api/ts" target="_blank" rel="noopener noreferrer" class="footer__link-item">Client API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">COMMUNITY</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.com/invite/sNeGymrabT" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/switchboardxyz" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/switchboardxyz" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/switchboardxyz" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">MORE</div><ul class="footer__items"><li class="footer__item"><a href="https://switchboardxyz.medium.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://app.trinethire.com/companies/35264-switchboard-technology-labs/jobs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Jobs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/switchboard-xyz" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/assets/js/runtime~main.167300c3.js"></script>
<script src="/assets/js/main.006ccf51.js"></script>
</body>
</html>